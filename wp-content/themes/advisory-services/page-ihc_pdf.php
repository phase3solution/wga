<?php /* Template Name: IHC PDF */get_header();global $user_switching;$postType = !empty($_GET['p']) ? trim($_GET['p']) : 'ihc';if ($postType == 'bia') { $pageTitle = 'BIA PDF'; $pageIcon =  'icon-ihcr.png'; $prefix = $postType.'_pdf_';}else if ($postType == 'mta') { $pageTitle = 'MTA PDF'; $pageIcon =  'icon-ihcr.png'; $prefix = $postType.'_pdf_';}else { $pageTitle = 'IHC PDF'; $pageIcon =  'icon-ihcr.png'; $prefix = $postType.'_pdf_';}echo '<div class="content-wrapper">';	$postID = 0;    pageTitleAndBreadcrumb($pageTitle, $pageIcon);    $company_id = advisory_get_user_company_id();	$query = new WP_Query([	    'post_type' => $postType,	    'post_status' => ['publish','archived'],	    'posts_per_page' => 1,	    'meta_query' => [['key' => 'assigned_company', 'value' => $company_id]],	    'fields' => 'ids',	]);	if ($query->found_posts > 0) {		$postID = $query->posts[0]; 		if (isset($_POST['updateBtn'])) {			unset($_POST['updateBtn']);			updateCompanyMeta($company_id, $prefix, $_POST);			?><script>(function() { swal("Success", "Updated successfully.", "info") })</script><?php			echo '<div class="alert alert-success" role="alert">Updated successfully.<button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div>';		}		$meta = get_post_meta($postID, 'form_opts', true);		$pdfData = get_term_meta($company_id, $prefix, true);		$html = '';		if ($meta) {			$areaSI = 0;			if (empty($meta['areas'])) echo '<div class="text-center text-danger">Areas are not defined';			else {				echo '<hr/>';				echo '<form class="tabContainer" method="post">';				    echo '<div class="row">';				        echo renderPDFTabNav($meta['areas'], $postType);				        echo '<div class="col-sm-9">';				            echo '<div class="tab-content card">';				            	if ($postType == 'bia') {					                foreach ($meta['areas'] as $area) {					                	$active = $areaSI < 1 ? ' active' : '';					                	echo '<div role="tabpanel" class="tab-pane'. $active .'" id="'. advisory_id_from_string($area['name']) .'">';					                	echo advisoryGenerateBIAPDF($area, $meta, $pdfData, $prefix);					                	echo '</div>';					                	$areaSI++;					            	}				            	} else {				            		echo '<div role="tabpanel" class="tab-pane active" id="pdfgeneral">';				                		echo renderTabContentFor([['id' => $prefix.'title', 'type' => 'text', 'title' => 'Title', 'value' => !empty($pdfData[$prefix.'title']) ? $pdfData[$prefix.'title'] : '']]);				                	echo '</div>';					                foreach ($meta['areas'] as $area) {					                	echo '<div role="tabpanel" class="tab-pane" id="'. advisory_id_from_string($area['name']) .'">';					                	echo advisoryGenerateIHCPDF($area, $meta, $pdfData, $prefix);					                	echo '</div>';					            	}				            	}				            echo '</div>';				        echo '</div>';				    echo '</div>';				    echo '<button type="submit" name="updateBtn" class="btn btn-primary btn-lg">Update</button>';				echo '</form>';			}			echo $html;		}	} else {		echo '<p>' . __('Register Not Available Yet') . '</p>';	}echo '</div>';get_footer();